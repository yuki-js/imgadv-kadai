### 前提

kadai-prompt.md の内容を踏まえた上で、Query 5の考察をさらに深めるためのさらなるQueryを追加します。
kadai-prompt.md の内容を参照してください。

### Pre-Query

GPUを用いて計算を高速化する準備をせよ。現行の処理ですらとても時間がかかるため、GPUを用いた高速化は必須である。
対象の画像をすべてGPUに転送し、今までCPUで行っていた計算をGPU上で行うようにコードを書き換えよ。CPUとGPUの間でデータを転送する回数を最小限に抑えること。
Query 1-4は対象外。

### Query 6

3D plotで可視化したが、部分空間法とtrainデータを用いて分類器を作り、その分類器の決定境界を3D plotで可視化せよ。また、testデータを用いてその分類器の精度を評価せよ。
Matplotlibなどのライブラリを用いて、3D plot上に決定境界を描画すること。マウスで回転させて決定境界を様々な角度から観察できるようにすること。
決定境界は二次曲面とする。

### Query 7

マスクのサイズによって分離の仕方が変化する。例えば、鼻を隠すと、3d plotでのクラスターの分離のされ方が目に見えて変わる。マスクのパターンを変更させながら、よい分離を得られるマスクのパターンを探索する仕組みを考えよ。私はアイデアがないからだ。
分類器を作れ、というわけではない。3D空間内で分離の良さを評価すること。人間的な尺度でいうと、「クラスター同士が離れている」「クラスター内の点が密集している」「境界付近に点が少ない」などがある。機械的な尺度としてもアイデアがない。
マスクの生成やマスク適用の処理もGPU上で行うこと。

### output

srcとは分離し、src-gpuディレクトリを新たに作成すること。
- src-gpu/common.py: 共通関数群
- src-gpu/dataload.py: データセットの読み込みと前処理
- src-gpu/subspace-construction.py: 部分空間構築クラスの定義
- src-gpu/query6.py: Query 6の実装
- src-gpu/query7.py: Query 7の実装

CuPyでもPyTorch.Tensorでもよいが、コード全体で一貫性を持たせること。