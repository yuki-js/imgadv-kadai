### 前提

kadai-prompt.md の内容を踏まえた上で、Query 5の考察をさらに深めるためのさらなるQueryを追加します。
kadai-prompt.md の内容を参照してください。

### Pre-Query

GPUを用いて計算を高速化する準備をせよ。現行の処理ですらとても時間がかかるため、GPUを用いた高速化は必須である。
対象の画像をすべてGPUに転送し、今までCPUで行っていた計算をGPU上で行うようにコードを書き換えよ。CPUとGPUの間でデータを転送する回数を最小限に抑えること。
Query 1-4は対象外。

### Query 6

3D plotで可視化したが、部分空間法とtrainデータを用いて分類器を作り、その分類器の決定境界を3D plotで可視化せよ。また、testデータを用いてその分類器の精度を評価せよ。
Matplotlibなどのライブラリを用いて、3D plot上に決定境界を描画すること。マウスで回転させて決定境界を様々な角度から観察できるようにすること。
決定境界は二次曲面とする。

### Query 7

マスクのサイズによって分類精度が変化する。例えば、鼻を隠すと、3d plotでのクラスターの分離のされ方が目に見えて変わる。マスクのパターンを変更させながら、よい分類精度を得られるマスクのパターンを探索せよ。
マスクは、12x12の正方形4つを基本として、8ピクセルずつずらしながら、部分空間法を用いて分類器を作成し、testデータでの分類精度を評価せよ。
マスクの生成やマスク適用の処理もGPU上で行うこと。